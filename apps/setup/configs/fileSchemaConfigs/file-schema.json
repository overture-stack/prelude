{
  "name": "fileSchema",
  "schema": {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": [
      "studyId",
      "analysisType",
      "files",
      "donor",
      "specimen",
      "workflow",
      "experiment"
    ],
    "definitions": {
      "common": {
        "md5": {
          "type": "string",
          "pattern": "^[a-fA-F0-9]{32}$"
        },
        "submitterId": {
          "type": "string",
          "pattern": "^[A-Za-z0-9\\-\\._]{1,64}$"
        },
        "info": {
          "type": "object"
        }
      },
      "file": {
        "fileType": {
          "type": "string"
        },
        "fileData": {
          "type": "object",
          "required": [
            "dataType",
            "fileName",
            "fileSize",
            "fileType",
            "fileAccess",
            "fileMd5sum"
          ],
          "properties": {
            "dataType": {
              "type": "string"
            },
            "fileName": {
              "type": "string",
              "pattern": "^[A-Za-z0-9_\\.\\-\\[\\]\\(\\)]+$"
            },
            "fileSize": {
              "type": "integer",
              "minimum": 0
            },
            "fileAccess": {
              "type": "string",
              "enum": ["open", "controlled"]
            },
            "fileType": {
              "$ref": "#/definitions/file/fileType"
            },
            "fileMd5sum": {
              "$ref": "#/definitions/common/md5"
            },
            "info": {
              "$ref": "#/definitions/common/info"
            }
          }
        }
      },
      "analysisType": {
        "type": "object",
        "required": ["name"],
        "properties": {
          "name": {
            "type": "string"
          },
          "version": {
            "type": ["integer", "null"]
          }
        }
      }
    },
    "properties": {
      "analysisId": {
        "not": {}
      },
      "studyId": {
        "type": "string",
        "minLength": 1
      },
      "analysisType": {
        "allOf": [
          {
            "$ref": "#/definitions/analysisType"
          }
        ]
      },
      "files": {
        "type": "array",
        "minItems": 1,
        "items": {
          "$ref": "#/definitions/file/fileData"
        }
      },
      "donor": {
        "if": {
          "properties": {
            "vitalStatus": {
              "const": "Deceased"
            }
          }
        },
        "then": {
          "required": ["causeOfDeath", "survivalTime"]
        },
        "type": "object",
        "required": [
          "submitterDonorId",
          "primarySite",
          "vitalStatus",
          "primaryDiagnosis"
        ],
        "properties": {
          "submitterDonorId": {
            "type": "string"
          },
          "primarySite": {
            "type": "string",
            "enum": [
              "Accessory sinuses",
              "Adrenal gland",
              "Base of tongue",
              "Bladder",
              "Bones, joints and articular cartilage of limbs",
              "Bones, joints and articular cartilage of other and unspecified sites",
              "Brain",
              "Breast",
              "Bronchus and lung",
              "Cervix uteri",
              "Colon",
              "Connective, subcutaneous and other soft tissues",
              "Corpus uteri",
              "Esophagus",
              "Eye and adnexa",
              "Floor of mouth",
              "Gallbladder",
              "Gum",
              "Heart, mediastinum, and pleura",
              "Hematopoietic and reticuloendothelial systems",
              "Hypopharynx",
              "Kidney",
              "Larynx",
              "Lip",
              "Liver and intrahepatic bile ducts",
              "Lymph nodes",
              "Meninges",
              "Nasal cavity and middle ear",
              "Nasopharynx",
              "Oropharynx",
              "Other and ill-defined digestive organs",
              "Other and ill-defined sites",
              "Other and ill-defined sites in lip, oral cavity and pharynx",
              "Other and ill-defined sites within respiratory system and intrathoracic organs",
              "Other and unspecified female genital organs",
              "Other and unspecified major salivary glands",
              "Other and unspecified male genital organs",
              "Other and unspecified parts of biliary tract",
              "Other and unspecified parts of mouth",
              "Other and unspecified parts of tongue",
              "Other and unspecified urinary organs",
              "Other endocrine glands and related structures",
              "Ovary",
              "Palate",
              "Pancreas",
              "Parotid gland",
              "Penis",
              "Peripheral nerves and autonomic nervous system",
              "Placenta",
              "Prostate gland",
              "Pyriform sinus",
              "Rectosigmoid junction",
              "Rectum",
              "Renal pelvis",
              "Retroperitoneum and peritoneum",
              "Skin",
              "Small intestine",
              "Spinal cord, cranial nerves, and other parts of central nervous system",
              "Stomach",
              "Testis",
              "Thymus",
              "Thyroid gland",
              "Tonsil",
              "Trachea",
              "Ureter",
              "Uterus, NOS",
              "Vagina",
              "Vulva"
            ]
          },
          "vitalStatus": {
            "type": "string",
            "enum": ["Alive", "Deceased"]
          },
          "causeOfDeath": {
            "type": ["null", "string"],
            "enum": ["Died of cancer", "Died of other reasons", "Unknown", null]
          },
          "survivalTime": {
            "type": ["null", "integer"],
            "minimum": 0
          },
          "primaryDiagnosis": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": [
                "submitterPrimaryDiagnosisId",
                "ageAtDiagnosis",
                "cancerTypeCode"
              ],
              "properties": {
                "submitterPrimaryDiagnosisId": {
                  "type": "string"
                },
                "ageAtDiagnosis": {
                  "type": "integer",
                  "minimum": 0
                },
                "cancerTypeCode": {
                  "type": "string",
                  "pattern": "^[C|D][0-9]{2}(.[0-9]{1,3}[A-Z]{0,1})?$"
                },
                "clinicalTumourStagingSystem": {
                  "type": "string",
                  "enum": [
                    "AJCC 8th edition",
                    "AJCC 7th edition",
                    "AJCC 6th edition",
                    "Ann Arbor staging system",
                    "Binet staging system",
                    "Durie-Salmon staging system",
                    "FIGO staging system",
                    "Lugano staging system",
                    "Rai staging system",
                    "Revised International staging system (RISS)",
                    "St Jude staging system"
                  ]
                },
                "clinicalStageGroup": {
                  "type": "string"
                }
              },
              "propertyNames": {
                "enum": [
                  "submitterPrimaryDiagnosisId",
                  "ageAtDiagnosis",
                  "cancerTypeCode",
                  "clinicalTumourStagingSystem",
                  "clinicalStageGroup",
                  "treatment",
                  "followUp"
                ]
              }
            }
          }
        },
        "propertyNames": {
          "enum": [
            "submitterDonorId",
            "primarySite",
            "vitalStatus",
            "survivalTime",
            "causeOfDeath",
            "primaryDiagnosis"
          ]
        }
      },
      "specimen": {
        "type": "object",
        "required": [
          "submitterSpecimenId",
          "submitterPrimaryDiagnosisId",
          "specimenAnatomicLocation"
        ],
        "properties": {
          "submitterSpecimenId": {
            "type": "string"
          },
          "submitterPrimaryDiagnosisId": {
            "type": "string"
          },
          "specimenAnatomicLocation": {
            "type": "string",
            "pattern": "^[C][0-9]{2}(.[0-9]{1})?$"
          },
          "tumourGradingSystem": {
            "type": "string",
            "enum": [
              "FNCLCC grading system",
              "Four-tier grading system",
              "Gleason grade group system",
              "Grading system for GISTs",
              "Grading system for GNETs",
              "ISUP grading system",
              "Nuclear grading system for DCIS",
              "Scarff-Bloom-Richardson grading system",
              "Three-tier grading system",
              "Two-tier grading system",
              "WHO grading system for CNS tumours"
            ]
          },
          "tumourGrade": {
            "type": "string",
            "enum": [
              "Low grade",
              "High grade",
              "GX",
              "G1",
              "G2",
              "G3",
              "G4",
              "Low",
              "High",
              "Grade I",
              "Grade II",
              "Grade III",
              "Grade IV",
              "Grade Group 1",
              "Grade Group 2",
              "Grade Group 3",
              "Grade Group 4",
              "Grade Group 5"
            ]
          }
        },
        "propertyNames": {
          "enum": [
            "submitterSpecimenId",
            "submitterPrimaryDiagnosisId",
            "specimenAnatomicLocation",
            "tumourGradingSystem",
            "tumourGrade"
          ]
        }
      },
      "workflow": {
        "type": "object",
        "required": ["workflowName", "genomeBuild", "inputs"],
        "properties": {
          "workflowName": {
            "type": "string",
            "pattern": "^[a-zA-Z][a-zA-Z0-9 _\\-]+[a-zA-Z0-9]+$"
          },
          "workflowShortName": {
            "type": "string",
            "pattern": "^[a-zA-Z][a-zA-Z0-9_\\-]+[a-zA-Z0-9]+$"
          },
          "workflowVersion": {
            "type": "string"
          },
          "genomeBuild": {
            "type": "string",
            "enum": ["GRCh37", "GRCh38_hla_decoy_ebv", "GRCh38_Verily_v1"]
          },
          "inputs": {
            "type": "array",
            "minItems": 1,
            "maxItems": 2,
            "items": {
              "type": "object",
              "properties": {
                "analysisType": {
                  "type": "string"
                },
                "normalAnalysisId": {
                  "type": "string",
                  "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{13}$"
                },
                "tumourAnalysisId": {
                  "type": "string",
                  "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{13}$"
                }
              }
            }
          },
          "sessionId": {
            "type": "string",
            "pattern": "SI[0-9]{4}"
          },
          "runId": {
            "type": "string"
          }
        },
        "propertyNames": {
          "enum": [
            "workflowName",
            "workflowShortName",
            "workflowVersion",
            "genomeBuild",
            "inputs",
            "sessionId",
            "runId"
          ]
        }
      },
      "experiment": {
        "type": "object",
        "required": ["platform", "experimentalStrategy"],
        "properties": {
          "platform": {
            "type": ["string", "null"]
          },
          "experimentalStrategy": {
            "type": ["string", "null"]
          },
          "model": {
            "type": ["string", "null"]
          },
          "sequencingCenter": {
            "type": ["string", "null"]
          },
          "sequencingDate": {
            "type": ["string", "null"],
            "pattern": "^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?(Z|[+-](?:2[0-3]|[01][0-9]):[0-5][0-9])?$"
          }
        },
        "propertyNames": {
          "enum": [
            "platform",
            "experimentalStrategy",
            "model",
            "sequencingCenter",
            "sequencingDate"
          ]
        }
      },
      "publication": {
        "type": "object",
        "properties": {
          "publication": {
            "type": ["string", "null"]
          },
          "doi": {
            "type": ["string", "null"]
          }
        },
        "propertyNames": {
          "enum": ["publication", "doi"]
        }
      },
      "collaborator": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["name"],
          "properties": {
            "name": {
              "type": "string"
            },
            "contactEmail": {
              "type": ["string", "null"],
              "pattern": "^\\S+@\\S+\\.\\S+$"
            }
          },
          "propertyNames": {
            "enum": ["name", "contactEmail"]
          }
        }
      }
    }
  },
  "options": {
    "fileTypes": [],
    "externalValidations": []
  }
}
